import cv2
import numpy as np
import matplotlib.pyplot as plt
from skimage.metrics import structural_similarity as ssim

# Load and convert the image to RGB
image = cv2.imread('fruit.jpg')
image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)

# Define and apply kernels
blurred = cv2.filter2D(image_rgb, -1, np.ones((9, 9), np.float32) / 81)
smoothed = cv2.filter2D(image_rgb, -1, np.array([[2, 2, 2], [2, 10, 2], [2, 2, 2]], np.float32) / 18)

# Convert to grayscale for SSIM
gray = lambda img: cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)
ssim_blurred = ssim(gray(image_rgb), gray(blurred))
ssim_smoothed = ssim(gray(image_rgb), gray(smoothed))

# Print SSIM values
print(f'SSIM between original and blurred images: {ssim_blurred:.4f}')
print(f'SSIM between original and smoothed images: {ssim_smoothed:.4f}')

# Plot images
titles = ['Original Image', 'Blurred Image', 'Smoothed Image']
images = [image_rgb, blurred, smoothed]
fig, axs = plt.subplots(1, 3, figsize=(15, 5))

for ax, img, title in zip(axs, images, titles):
    ax.imshow(img)
    ax.set_title(title)
    ax.axis('off')

plt.tight_layout()
plt.show()
